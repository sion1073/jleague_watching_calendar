# Flutter Webプロジェクトのセットアップ 議事録

**日付**: 2026-02-03

---

## 議事録を確認し、「Flutter Webプロジェクトのセットアップ」から初めてください

---

## 対応内容

前回の議事録（2026-02-02_02.md）で決定した方針に基づき、Flutter Webプロジェクトのセットアップを実施しました。

### 確認した開発方針（前回の議事録より）

#### フェーズ1: プロトタイプ
- **配布**: GitHub Pages（PWA）
- **認証**: 簡易パスワード認証（SHA-256ハッシュ比較）
- **データ**: ブラウザ内部ストレージ（IndexedDB/Hive）
- **バックアップ**: JSONエクスポート/インポート

#### フェーズ2: 本番化
- **配布**: GitHub Pages（継続）
- **認証**: GitHub OAuth
- **データ**: ローカル + GitHub Gist（自動バックアップ）
- **バックアップ**: Gist + 手動エクスポート

---

## Flutter環境のセットアップ

### 初回確認時の状況
- Flutterがインストールされていなかった
- ユーザーがFlutterを導入後、再開

### 環境確認結果
```
Flutter 3.38.9 • channel stable
Dart 3.10.8
```

### Flutter Web対応の有効化
```bash
flutter config --enable-web
```

---

## プロジェクトの作成

### 実行コマンド
```bash
cd ~/99_その他/jleague_watching_calendar
flutter create --platforms=web .
```

### 作成されたファイル
- `pubspec.yaml` - 依存関係設定
- `lib/main.dart` - メインアプリケーション
- `web/index.html` - HTMLエントリーポイント
- `web/manifest.json` - PWA設定
- `web/icons/` - アプリアイコン各種
- `analysis_options.yaml` - Linter設定
- `test/widget_test.dart` - テストファイル

---

## プロジェクト構造の整備

### ディレクトリ構造
```bash
mkdir -p lib/models lib/services lib/screens lib/widgets lib/utils
```

作成したディレクトリ：
- `lib/models/` - データモデル
- `lib/services/` - ビジネスロジック（認証、ストレージ等）
- `lib/screens/` - 画面
- `lib/widgets/` - 再利用可能なウィジェット
- `lib/utils/` - ユーティリティ関数

---

## 依存関係の追加

### pubspec.yaml の更新内容

#### プロジェクト情報
```yaml
name: jleague_watching_calendar
description: "J.LEAGUEの試合スケジュールと個人的なメモを管理するPWAアプリ"
```

#### 追加した依存関係
```yaml
dependencies:
  # ローカルストレージ（IndexedDB wrapper）
  hive: ^2.2.3
  hive_flutter: ^1.1.0

  # 簡易認証用（SHA-256ハッシュ）
  crypto: ^3.0.6

  # ローカル設定保存
  shared_preferences: ^2.3.4

  # 日付処理
  intl: ^0.20.2

  # HTTPリクエスト（将来のGist連携用）
  http: ^1.2.2

  # UUID生成
  uuid: ^4.5.1
```

### インストール実行
```bash
flutter pub get
```

**結果**: 37個の依存関係が追加された

---

## PWA設定のカスタマイズ

### web/manifest.json の更新

```json
{
    "name": "J.LEAGUE観戦カレンダー",
    "short_name": "観戦カレンダー",
    "start_url": ".",
    "display": "standalone",
    "background_color": "#1976D2",
    "theme_color": "#1976D2",
    "description": "J.LEAGUEの試合スケジュールと個人的なメモを管理するアプリ",
    "orientation": "portrait-primary",
    "prefer_related_applications": false,
    "icons": [...]
}
```

### web/index.html の更新

主な追加・変更点：
```html
<meta name="description" content="J.LEAGUEの試合スケジュールと個人的なメモを管理するアプリ">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<!-- iOS PWA対応 -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="観戦カレンダー">

<title>J.LEAGUE観戦カレンダー</title>
```

---

## GitHub Actions設定

### .github/workflows/deploy.yml の作成

GitHub Pagesへの自動デプロイ設定を追加：

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: stable
          cache: true

      - name: Install dependencies
        run: flutter pub get

      - name: Build Web
        run: flutter build web --release --base-href /jleague_watching_calendar/

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./build/web

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

**ポイント**:
- `main` ブランチへのプッシュで自動デプロイ
- `--base-href /jleague_watching_calendar/` でサブディレクトリ対応
- GitHub Actions経由でGitHub Pagesにデプロイ

---

## README.md の作成

包括的なREADMEを作成：

### 含まれる内容
- プロジェクトの特徴
- 技術スタック
- 開発フェーズ（チェックリスト形式）
- セットアップ手順
- デプロイ方法
- プロジェクト構造
- ライセンス情報

### 開発フェーズのチェックリスト

**フェーズ1: プロトタイプ（現在）**
- [x] プロジェクトセットアップ
- [x] PWA設定
- [ ] 簡易パスワード認証実装
- [ ] データモデル設計
- [ ] 基本UI実装

**フェーズ2: コア機能開発**
- [ ] 予定の登録・編集・削除
- [ ] メモ機能
- [ ] 検索・フィルタリング機能
- [ ] エクスポート/インポート機能

**フェーズ3: 本番化**
- [ ] GitHub OAuth実装
- [ ] GitHub Gist連携（自動バックアップ）
- [ ] UI/UX改善

---

## ビルド確認

### 実行コマンド
```bash
flutter build web --release --base-href /jleague_watching_calendar/
```

### 結果
```
✓ Built build/web

ビルド時間: 26.0秒
```

**最適化結果**:
- CupertinoIcons: 257KB → 1.4KB（99.4%削減）
- MaterialIcons: 1.6MB → 7.8KB（99.5%削減）

---

## Flutter Doctor の結果

```
[✓] Flutter (Channel stable, 3.38.9)
[✗] Android toolchain - 未インストール（Web開発には不要）
[✗] Xcode - 未インストール（Web開発には不要）
[✓] Chrome - develop for the web
[✓] Connected device (2 available)
[✓] Network resources
```

**結論**: Web開発に必要な環境は整っている

---

## 完了した作業まとめ

1. ✅ Flutter環境確認（3.38.9）とWeb対応有効化
2. ✅ Flutter Webプロジェクト作成
3. ✅ 依存関係追加（Hive、crypto、shared_preferences、http等）
4. ✅ PWA設定カスタマイズ（manifest.json、index.html）
5. ✅ GitHub Actions自動デプロイ設定
6. ✅ プロジェクト構造整備（models、services、screens等）
7. ✅ README作成（詳細なドキュメント）
8. ✅ Webビルド確認（成功）

---

## プロジェクト最終構造

```
jleague_watching_calendar/
├── .github/
│   └── workflows/
│       └── deploy.yml          # GitHub Actions設定
├── lib/
│   ├── main.dart              # アプリのエントリーポイント
│   ├── models/                # データモデル（未実装）
│   ├── services/              # ビジネスロジック（未実装）
│   ├── screens/               # 画面（未実装）
│   ├── widgets/               # 再利用可能なウィジェット（未実装）
│   └── utils/                 # ユーティリティ関数（未実装）
├── web/
│   ├── index.html             # HTMLエントリーポイント（カスタマイズ済み）
│   ├── manifest.json          # PWA設定（カスタマイズ済み）
│   ├── favicon.png
│   └── icons/                 # アプリアイコン
├── test/
│   └── widget_test.dart       # テストファイル
├── ai_chat_log/               # 開発記録
│   ├── 2026-02-02_02.md      # 前回の議事録
│   └── 2026-02-03_01.md      # 本議事録
├── pubspec.yaml               # 依存関係設定（更新済み）
├── analysis_options.yaml      # Linter設定
└── README.md                  # プロジェクトドキュメント
```

---

## 次のステップ

### フェーズ1の残りタスク

1. **簡易パスワード認証の実装**
   - `lib/services/simple_auth_service.dart` の作成
   - `lib/screens/login_screen.dart` の作成
   - SHA-256ハッシュによる認証ロジック
   - SharedPreferencesでセッション管理

2. **データモデル設計**
   - `lib/models/schedule.dart` - スケジュールモデル
   - `lib/models/memo.dart` - メモモデル
   - Hiveのアダプター作成

3. **基本UI実装**
   - ホーム画面
   - スケジュール一覧画面
   - 簡易ナビゲーション

### デプロイに向けて

- GitHubリポジトリにプッシュ
- GitHub Pages設定（Settings > Pages > Source: GitHub Actions）
- 動作確認

---

## 技術的な決定事項

### 認証方式
- **フェーズ1**: SHA-256ハッシュベースの簡易認証
  - パスワードをハッシュ化してコードに埋め込み
  - セキュリティは限定的だが、プロトタイプとしては十分
  - 個人利用想定のため許容範囲

- **フェーズ3**: GitHub OAuth
  - より安全な認証
  - GitHub Gistとの連携も可能

### データ管理
- **ローカルストレージ**: Hive（IndexedDBのラッパー）
  - オフライン動作可能
  - 高速なデータアクセス
  - TypeScriptのような型安全性

- **バックアップ**: JSON形式
  - エクスポート/インポート機能
  - 将来的にGist連携

### PWA対応
- Service Workerは自動生成（Flutter Web標準）
- iOS対応のメタタグを追加
- ホーム画面への追加に対応

---

## 参考情報

### Flutter Web公式ドキュメント
- https://docs.flutter.dev/platform-integration/web

### GitHub Pages設定
- リポジトリ Settings > Pages
- Source を "GitHub Actions" に設定
- デプロイURL: `https://[username].github.io/jleague_watching_calendar/`

### ビルドコマンド
```bash
# 開発サーバー起動
flutter run -d chrome

# リリースビルド
flutter build web --release --base-href /jleague_watching_calendar/

# 依存関係の更新
flutter pub get

# Flutter環境確認
flutter doctor
```

---

## 備考

- Android/iOS環境は未インストールだが、Web開発には影響なし
- Flutterのツリーシェイキングにより、フォントサイズが大幅に削減されている
- Wasmビルドオプションも利用可能（`--wasm`フラグ）

---

## 次回セッションで実施予定

1. 簡易パスワード認証の実装
2. データモデルの設計と実装
3. 基本UI（ログイン画面、ホーム画面）の実装
4. GitHubへのプッシュとデプロイ確認

---

**次回の開始オプション**:
- **A**: 簡易パスワード認証を実装する
- **B**: データモデルを設計する
- **C**: まず基本的なUI（ホーム画面）を作る
- **D**: GitHubにプッシュしてデプロイ設定を確認する
