# J.LEAGUE観戦カレンダー 画面設計書

**作成日**: 2026-02-05
**形式**: Mermaid図 (ワイヤーフレーム)

---

## 📱 画面遷移図

```mermaid
graph TB
    Home[ホーム画面]
    LeagueList[リーグ一覧]
    SeasonDetail[シーズン詳細]
    TeamDetail[HOMEチーム詳細]
    MatchForm[予定登録・編集]
    Search[検索画面]

    Home -->|フッター: シーズン一覧| LeagueList
    Home -->|フッター: 検索| Search
    LeagueList -->|フッター: ホーム| Home
    LeagueList -->|フッター: 検索| Search
    Search -->|フッター: ホーム| Home
    Search -->|フッター: シーズン一覧| LeagueList

    LeagueList -->|シーズンをタップ| SeasonDetail
    LeagueList -->|チームをタップ| TeamDetail

    SeasonDetail -->|予定追加ボタン| MatchForm
    SeasonDetail -->|編集ボタン| MatchForm
    TeamDetail -->|予定追加ボタン<br/>日本代表のみ| MatchForm
    TeamDetail -->|編集ボタン| MatchForm

    MatchForm -->|保存・キャンセル| SeasonDetail
    MatchForm -->|保存・キャンセル| TeamDetail

    Search -->|検索結果をタップ| SeasonDetail
    Search -->|検索結果をタップ| TeamDetail

    style Home fill:#e1f5ff
    style LeagueList fill:#fff4e1
    style Search fill:#ffe1f5
```

---

## 🎨 全画面共通レイアウト

```mermaid
graph TB
    subgraph "全画面共通構造"
        Header["📌 ヘッダー<br/>━━━━━━━━━━━━━━━━<br/>J.LEAGUE観戦カレンダー"]
        Content["<br/><br/>📄 メインコンテンツ<br/>各画面の固有内容<br/><br/><br/>"]
        Footer["━━━━━━━━━━━━━━━━<br/>📊 シーズン一覧 | 📅 ホーム | 🔍 検索"]
    end

    Header --> Content
    Content --> Footer
```

### 共通要素の仕様

| 要素 | 内容 | 備考 |
|------|------|------|
| **ヘッダー** | タイトル表示 | 固定表示「J.LEAGUE観戦カレンダー」 |
| **フッター** | ナビゲーションアイコン | シーズン一覧・ホーム（カレンダーアイコン）・検索の3つ |

---

## 🏠 ホーム画面

```mermaid
graph TB
    subgraph "ホーム画面"
        Header1["ヘッダー: J.LEAGUE観戦カレンダー"]

        Calendar["📅 カレンダー<br/>━━━━━━━━━━━━━━━━<br/>月  火  水  木  金  土  日<br/>                 1   2   3<br/> 4   5  ⚽  7   8   9  10<br/>11  12  13  14 ⚽ 16  17<br/>18  19  20  21  22  23  24<br/>25  26  27  28  29  30  31<br/>━━━━━━━━━━━━━━━━<br/>⚽: 観戦予定日"]

        Stats["📊 観戦統計<br/>━━━━━━━━━━━━━━━━<br/>観戦数: 15試合<br/>勝利数: 8<br/>敗戦数: 5<br/>引き分け数: 2<br/>━━━━━━━━━━━━━━━━"]

        Footer1["フッター: シーズン一覧 | ホーム | 検索"]
    end

    Header1 --> Calendar
    Calendar --> Stats
    Stats --> Footer1
```

### 画面要素

| 要素 | 説明 |
|------|------|
| **カレンダー** | 月間カレンダー表示。観戦予定日にアイコン（⚽またはチームエンブレム）を表示 |
| **統計テーブル** | 全期間の観戦数、勝利数、敗戦数、引き分け数を表示 |

---

## 📊 リーグ一覧画面

```mermaid
graph TB
    subgraph "リーグ一覧画面"
        Header2["ヘッダー: J.LEAGUE観戦カレンダー"]

        TabSeason["━━━━━━━━━━━━━━━━<br/>[ シーズン ] | チーム<br/>━━━━━━━━━━━━━━━━"]

        SeasonList["📋 シーズンリスト<br/>━━━━━━━━━━━━━━━━<br/>▸ 2026シーズン (12試合)<br/>▸ 2025シーズン (18試合)<br/>▸ 2024シーズン (15試合)<br/>━━━━━━━━━━━━━━━━"]

        Footer2["フッター: リーグ一覧 | ホーム | 検索"]
    end

    Header2 --> TabSeason
    TabSeason --> SeasonList
    SeasonList --> Footer2
```

```mermaid
graph TB
    subgraph "リーグ一覧画面 - チームタブ"
        Header3["ヘッダー: J.LEAGUE観戦カレンダー"]

        TabTeam["━━━━━━━━━━━━━━━━<br/>シーズン | [ チーム ]<br/>━━━━━━━━━━━━━━━━"]

        TeamList["🏆 HOMEチームリスト<br/>━━━━━━━━━━━━━━━━<br/>▸ FC東京 (32試合)<br/>▸ 日本代表 (5試合)<br/>▸ 鹿島アントラーズ (3試合)<br/>━━━━━━━━━━━━━━━━"]

        Footer3["フッター: リーグ一覧 | ホーム | 検索"]
    end

    Header3 --> TabTeam
    TabTeam --> TeamList
    TeamList --> Footer3
```

### 画面要素

| 要素 | 説明 |
|------|------|
| **タブ切り替え** | シーズン / HOMEチーム の2つのタブ |
| **シーズンリスト** | 年度別のシーズンと試合数を表示。**日本代表は除外**（チームタブに表示）。タップで詳細画面へ |
| **チームリスト** | HOMEチーム別の観戦試合数を表示。日本代表を含む。タップで詳細画面へ |

---

## 📅 シーズン詳細画面

```mermaid
graph TB
    subgraph "シーズン詳細画面"
        Header4["ヘッダー: 2026シーズン"]

        AddButton["━━━━━━━━━━━━━━━━<br/>[+ 予定を追加]<br/>━━━━━━━━━━━━━━━━"]

        ExpandButton["━━━━━━━━━━━━━━━━<br/>[▼ 詳細情報を表示] (トグルボタン)<br/>━━━━━━━━━━━━━━━━"]

        MatchTable["📋 観戦記録テーブル (シンプル表示)<br/>━━━━━━━━━━━━━━━━<br/>日付       HOME  vs  対戦相手  結果  [編集]<br/>2026/02/15  FC東京 vs 浦和    3-2   [✏️]<br/>2026/03/01  FC東京 vs 鹿島    1-1   [✏️]<br/>2026/03/15  FC東京 vs 横浜FM  2-3   [✏️]<br/>━━━━━━━━━━━━━━━━"]

        MatchTableExpanded["📋 観戦記録テーブル (詳細表示)<br/>━━━━━━━━━━━━━━━━<br/>▸ 2026/02/15 FC東京 vs 浦和 (3-2)<br/>  得点者: 田中(FC東京), 佐藤(FC東京), 鈴木(浦和)<br/>  メモ: 初めてのスタジアム観戦<br/>▸ 2026/03/01 FC東京 vs 鹿島 (1-1)<br/>  得点者: 山田(FC東京)<br/>  メモ: 雨天での試合<br/>━━━━━━━━━━━━━━━━"]

        Footer4["フッター: リーグ一覧 | ホーム | 検索"]
    end

    Header4 --> AddButton
    AddButton --> ExpandButton
    ExpandButton -->|デフォルト| MatchTable
    ExpandButton -->|ボタンON時| MatchTableExpanded
    MatchTable --> Footer4
    MatchTableExpanded --> Footer4
```

### 画面要素

| 要素 | 説明 |
|------|------|
| **予定追加ボタン** | タップで予定登録画面へ遷移 |
| **情報拡張ボタン** | トグルボタン。押すと得点者・メモなど詳細情報を表示/非表示切り替え |
| **観戦記録テーブル** | 日付、HOME、対戦相手、結果を一覧表示<br/>**詳細モード**: 得点者、メモも表示 |
| **編集ボタン** | 各行の右端に配置。タップで編集画面へ |

---

## 🏆 HOMEチーム詳細画面

```mermaid
graph TB
    subgraph "HOMEチーム詳細画面"
        Header5["ヘッダー: FC東京"]

        AddButton2["━━━━━━━━━━━━━━━━<br/>日本代表の場合のみ表示:<br/>[+ 予定を追加]<br/>━━━━━━━━━━━━━━━━"]

        ExpandButton2["━━━━━━━━━━━━━━━━<br/>[▼ 詳細情報を表示] (トグルボタン)<br/>━━━━━━━━━━━━━━━━"]

        MatchTable2["📋 観戦記録 (シンプル表示)<br/>━━━━━━━━━━━━━━━━<br/>シーズン  日付      対戦相手  結果  [編集]<br/>2026    2026/03/15  横浜FM   2-3   [✏️]<br/>2026    2026/03/01  鹿島     1-1   [✏️]<br/>2025    2025/11/23  浦和     3-2   [✏️]<br/>2025    2025/10/15  神戸     0-1   [✏️]<br/>━━━━━━━━━━━━━━━━"]

        MatchTable2Expanded["📋 観戦記録 (詳細表示)<br/>━━━━━━━━━━━━━━━━<br/>▸ 2026 2026/03/15 vs 横浜FM (2-3)<br/>  得点者: 田中, 佐藤<br/>  メモ: アウェイ観戦<br/>▸ 2026 2026/03/01 vs 鹿島 (1-1)<br/>  得点者: 山田<br/>━━━━━━━━━━━━━━━━"]

        Footer5["フッター: リーグ一覧 | ホーム | 検索"]
    end

    Header5 --> AddButton2
    AddButton2 --> ExpandButton2
    ExpandButton2 -->|デフォルト| MatchTable2
    ExpandButton2 -->|ボタンON時| MatchTable2Expanded
    MatchTable2 --> Footer5
    MatchTable2Expanded --> Footer5
```

### 画面要素

| 要素 | 説明 |
|------|------|
| **予定追加ボタン** | 日本代表の場合のみ表示。Jリーグチームは各シーズンで管理 |
| **情報拡張ボタン** | トグルボタン。押すと得点者・メモなど詳細情報を表示/非表示切り替え |
| **観戦記録テーブル** | シーズンを横断した一覧。シーズン列を追加<br/>**詳細モード**: 得点者、メモも表示 |
| **編集ボタン** | 各行の右端に配置 |

---

## ✏️ 予定登録・編集画面

```mermaid
graph TB
    subgraph "予定登録・編集画面"
        Header6["ヘッダー: 予定登録 / 編集"]

        Form["📝 入力フォーム<br/>━━━━━━━━━━━━━━━━<br/>シーズン: [2026シーズン ▼]<br/>━━━━━━━━━━━━━━━━<br/>試合日: [2026/03/20]<br/>━━━━━━━━━━━━━━━━<br/>HOME: [FC東京]<br/>━━━━━━━━━━━━━━━━<br/>対戦相手: [浦和レッズ]<br/>━━━━━━━━━━━━━━━━<br/>結果: [3] - [2]<br/>━━━━━━━━━━━━━━━━<br/>勝敗: [Win ▼]<br/>━━━━━━━━━━━━━━━━<br/>得点者:<br/>[+ 得点者を追加]<br/>━━━━━━━━━━━━━━━━<br/>メモ:<br/>[__________________]<br/>━━━━━━━━━━━━━━━━"]

        Buttons["[保存] [キャンセル]"]

        Footer6["フッター: リーグ一覧 | ホーム | 検索"]
    end

    Header6 --> Form
    Form --> Buttons
    Buttons --> Footer6
```

### 画面要素（データモデルに対応）

| フィールド | 入力形式 | 必須 |
|------------|---------|------|
| **シーズン** | ドロップダウン | ✅ |
| **試合日** | 日付ピッカー | ✅ |
| **HOME** | テキスト入力 | ✅ |
| **対戦相手** | テキスト入力 | ✅ |
| **結果** | 数値入力 (スコア) | - |
| **勝敗** | ドロップダウン (Win/Lose/Draw) | - |
| **得点者** | 動的追加可能なリスト | - |
| **メモ** | 複数行テキスト | - |

---

## 🔍 検索画面

```mermaid
graph TB
    subgraph "検索画面"
        Header7["ヘッダー: 検索"]

        SearchForm["🔍 検索フォーム<br/>━━━━━━━━━━━━━━━━<br/>キーワード: [_______________] [検索]<br/>━━━━━━━━━━━━━━━━<br/>シーズン: [すべて ▼]<br/>HOMEチーム: [すべて ▼]<br/>対戦相手: [すべて ▼]<br/>勝敗: [すべて ▼]<br/>━━━━━━━━━━━━━━━━"]

        Results["📋 検索結果 (詳細表示)<br/>━━━━━━━━━━━━━━━━<br/>15件の結果<br/>━━━━━━━━━━━━━━━━<br/>▸ 2026/03/15 FC東京 vs 横浜FM (2-3)<br/>  得点者: 田中, 佐藤<br/>  メモ: アウェイ観戦<br/>▸ 2026/03/01 FC東京 vs 鹿島 (1-1)<br/>  得点者: 山田<br/>  メモ: 雨天<br/>━━━━━━━━━━━━━━━━"]

        Footer7["フッター: リーグ一覧 | ホーム | 検索"]
    end

    Header7 --> SearchForm
    SearchForm --> Results
    Results --> Footer7
```

### 画面要素

| 要素 | 説明 |
|------|------|
| **検索フォーム** | キーワード、シーズン、チーム、対戦相手、勝敗でフィルタリング |
| **検索結果** | フォーム下部にリスト表示。**常に詳細情報（得点者・メモなど）を含めて表示**。タップで該当する詳細画面へ |

---

## 🎯 画面遷移の補足

### フッターナビゲーション
- **シーズン一覧**: シーズン/チームの一覧画面
- **ホーム**: カレンダーと統計を表示（カレンダーアイコン）
- **検索**: データ検索機能

### 編集フロー
1. シーズン詳細 / チーム詳細から「編集」をタップ
2. 予定登録・編集画面で内容を変更
3. 「保存」で元の画面に戻る

### 追加フロー
1. シーズン詳細 / チーム詳細（日本代表のみ）から「予定を追加」をタップ
2. 予定登録・編集画面で新規入力
3. 「保存」で元の画面に戻る

---

## 📐 レスポンシブ対応

PWAとして動作するため、以下の画面サイズに対応：

| デバイス | 対応 |
|----------|------|
| スマートフォン (縦) | ✅ メイン対象 |
| タブレット (縦/横) | ✅ 対応 |
| デスクトップ | △ 最小限対応 |

---

## 🚀 実装の優先順位

1. **Phase 1**: 全画面共通レイアウト + ホーム画面
2. **Phase 2**: リーグ一覧 + シーズン詳細
3. **Phase 3**: 予定登録・編集画面
4. **Phase 4**: HOMEチーム詳細 + 検索画面

---

## 💾 データモデルとの対応

既存のデータモデル（[lib/models/](lib/models/)）と画面の対応：

| 画面 | 使用モデル |
|------|-----------|
| ホーム画面 | `Season`, `MatchResult` (統計計算) |
| リーグ一覧 | `Season` |
| シーズン詳細 | `Season`, `MatchResult` |
| チーム詳細 | `MatchResult` (横断検索) |
| 予定登録・編集 | `Season`, `MatchResult`, `GoalScorer` |
| 検索 | すべてのモデル |

---

## 📝 補足事項

### カレンダーのアイコン表示
- **案1**: サッカーボール⚽（シンプル）
- **案2**: チームエンブレム（視覚的に分かりやすいが画像管理が必要）
- **推奨**: Phase 1ではサッカーボール、Phase 2以降でエンブレム対応

### 日本代表の扱い
- 「日本代表」を1つのシーズンとして扱う
- **シーズンリストには表示せず、チームリストのみに表示**
- HOMEチーム詳細画面では、日本代表の場合のみ予定追加ボタンを表示
- Jリーグチームの試合は各シーズンで管理

### 情報拡張機能
- **シーズン詳細画面**: トグルボタンで得点者・メモなどの詳細情報の表示/非表示を切り替え
- **HOMEチーム詳細画面**: トグルボタンで得点者・メモなどの詳細情報の表示/非表示を切り替え
- **検索画面**: 検索結果には常に詳細情報を含めて表示（トグル不要）

---

**作成者**: Claude Sonnet
**バージョン**: 1.4
**最終更新**: 2026-02-09

## 📝 変更履歴

### v1.4 (2026-02-09)
- Phase 3の実装完了：予定登録・編集画面
- 予定登録・編集画面（MatchFormScreen）の実装
  - 新規登録モード：シーズン詳細・日本代表のHOMEチーム詳細から遷移
  - 編集モード：試合一覧の編集ボタンから遷移
  - フォームバリデーション実装
  - 得点者の動的追加・削除（ダイアログUI）
  - 日本代表専用シーズンの自動作成機能
- シーズン詳細画面の予定追加・編集ボタンを実装
- HOMEチーム詳細画面の予定追加・編集ボタンを実装（日本代表のみ予定追加を表示）

### v1.3 (2026-02-06)
- Phase 2の実装完了：シーズン一覧・詳細・HOMEチーム詳細画面
- シーズン一覧画面（LeagueListScreen）の実装（シーズン/チームタブ）
- シーズン詳細画面（SeasonDetailScreen）の実装（詳細情報トグル機能付き）
- HOMEチーム詳細画面（TeamDetailScreen）の実装（日本代表判定機能付き）
- HomeScreenのナビゲーション実装

### v1.2 (2026-02-06)
- フッターナビゲーションの「リーグ一覧」を「シーズン一覧」に変更
- フッターの「ホーム」アイコンをカレンダーアイコンに変更

### v1.1 (2026-02-05)
- リーグ一覧のシーズンリストから日本代表を除外（チームタブのみに表示）
- シーズン詳細画面に情報拡張ボタンを追加
- HOMEチーム詳細画面に情報拡張ボタンを追加
- 検索結果を常に詳細表示に変更

### v1.0 (2026-02-05)
- 初版作成
